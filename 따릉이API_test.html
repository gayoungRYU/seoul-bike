<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>서울 공공자전거(따릉이) API TEST</title>
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
            crossorigin="anonymous"></script>
    <script>
        $(document).ready(function () {
            $("#search").click(function () {
                $.ajax({
                    method: "GET",
                    url: "http://openapi.seoul.go.kr:8088/464c4c7a7968677235307061734167/json/bikeList/497/500/",
                    data: {},
                    // success: function(response) {}
                })
                    .done(function (msg) {
                        alert(msg.rentBikeStatus.RESULT.MESSAGE);
                        console.log(msg);

                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[3].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[3].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[3].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[3].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[3].stationLatitude +
                            ", " + msg.rentBikeStatus.row[3].stationLongitude + "</div>");
                        
                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[4].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[4].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[4].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[4].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[4].stationLatitude +
                            ", " + msg.rentBikeStatus.row[4].stationLongitude + "</div>");
                        
                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[7].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[7].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[7].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[7].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[7].stationLatitude +
                            ", " + msg.rentBikeStatus.row[7].stationLongitude + "</div>");

                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[13].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[13].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[13].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[13].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[13].stationLatitude +
                            ", " + msg.rentBikeStatus.row[13].stationLongitude + "</div>");
                        
                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[16].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[16].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[16].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[16].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[16].stationLatitude +
                            ", " + msg.rentBikeStatus.row[16].stationLongitude + "</div>");

                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[52].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[52].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[52].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[52].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[52].stationLatitude +
                            ", " + msg.rentBikeStatus.row[52].stationLongitude + "</div>");
                        
                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[68].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[68].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[68].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[68].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[68].stationLatitude +
                            ", " + msg.rentBikeStatus.row[68].stationLongitude + "</div>");

                        $(".results").append("<div class=stationName>" + msg.rentBikeStatus.row[76].stationName + "</div>");
                        $(".results").append("<div class=contents>parkingBikeTotCnt = " + msg.rentBikeStatus.row[76].parkingBikeTotCnt + "</div>");
                        $(".results").append("<div class=contents>rackTotCnt = " + msg.rentBikeStatus.row[76].rackTotCnt + "</div>");
                        $(".results").append("<div class=contents>shared = " + msg.rentBikeStatus.row[76].shared + "</div>");
                        $(".results").append("<div class=coordinates>" + msg.rentBikeStatus.row[76].stationLatitude +
                            ", " + msg.rentBikeStatus.row[76].stationLongitude + "</div>");
                    });
            })
            // $.ajax({
            //     method: "GET",
            //     url: "//dapi.kakao.com/v2/maps/sdk.js?appkey=d41ef9ca3911495e4ad4aaa33aa2387d",
            //     data: {}
            // })
            // .done(functino (data) {
            //     alert("Successful");
            //     console.log(data);
            // });
        })
    </script>
    <style>
        .blueBox {
            margin: auto;
            width: 60%;
            border: 5px solid dodgerblue;
            padding: 30px;
        }
        .blueTitle {
            color: dodgerblue;
            font-size: 30px;
            font-weight: bold;
        }
        .searchButton {
            width: 300px;
            height: 80px;
            border: 5px solid dodgerblue;
            font-size: 20px;
        }
        .centerText {
            text-align: center;
        }
        .stationName {
            font-size: 20px;
            padding: 15px 10px 10px 0;
        }
        .contents {
            font-size: 12px;
            padding: 0 10px 5px 20px;
        }
        .coordinates {
            font-size: 12px;
            padding: 0 10px 5px 20px;
        }
        .results {
            font-size: 12px;
        }
        .additionalInfo {
            font-size: 12px;
        }
    </style>
</head>
<body>

    <div class="blueBox centerText blueTitle">
        <div class="blueTitle">서울 공공자전거(따릉이) API TEST</div>
    </div>
    <br>

    <div class="centerText">
        <button class="searchButton" id="search">정보 요청하기</button>
    </div>
    <br>

    <div class="blueBox">
        <div class="results"></div>
    </div>
    <br>

    <!-- Kakao Map API -->
    <div class="blueBox" id="map" style="width:60%;height:400px;"></div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=67e0974451f916d2823422baba0b0daf"></script>
	<script>
		var mapContainer = document.getElementById('map');
		var mapOption = {
			center: new kakao.maps.LatLng(37.520503, 126.869097),
			level: 5
		};
		var map = new kakao.maps.Map(mapContainer, mapOption);

		var node = document.getElementsByClassName("stationName");
        var stationName = node.textContent;
		var node1 = document.getElementsByClassName("coordinates");
		var coordinatesString = node1.textContent;

		//TODO: automate process
		var positions = [
            {
                title: '703',
                latlng: new kakao.maps.LatLng(37.52406311, 126.87557983)
            },
            {
                title: '785',
                latlng: new kakao.maps.LatLng(37.51732635, 126.86630249)
            },
            {
                title: stationName,
                latlng: new kakao.maps.LatLng(coordinatesString)
            }
        ];

		// Yellow circle markers
		var yellowCircleSrc = 'https://www.bikeseoul.com/img/icon_big2.png';

		for (var i = 0; i < positions.length; i++) {
            var yellowCircleSize = new kakao.maps.Size(15, 18), // 마커이미지의 크기입니다
                yellowCircleOption = {offset: new kakao.maps.Point(3, 12)}; //마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

            // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
            var yellowCircleImage = new kakao.maps.MarkerImage(yellowCircleSrc, yellowCircleSize, yellowCircleOption)

            // 마커를 생성합니다
            var yellowCircle = new kakao.maps.Marker({
                map: map,
                position: positions[i].latlng,
                title: positions[i].title,
                image: yellowCircleImage // 마커이미지 설정
            });
        }
        
        // Green circle markers
        // var greenCircleSrc = 'https://www.bikeseoul.com/img/icon_big1.png',
        //     greenCircleSize = new kakao.map.Size(15, 18),
        //     greenCircleOption = {offset: new kakao.maps.Point(3, 12)};
        //
        // var greenCircleImage = new kakao.maps.MarkerImage(greenCircleSrc, greenCircleSize, greenCircleOption),
        //     greenCirclePosition = new kakao.maps.LatLng(37.5240631, 126.87557983);
        //
        // var greenCircle = new kakao.maps.Marker({
        //     position: greenCirclePosition,
        //     image: greenCircleImage
        // });

        // 마커가 지도 위에 표시되도록 설정합니다
        yellowCircle.setMap(map);
        // greenCircle.setMap(map);
	</script>
    <br>

    <!-- Additional Info Box -->
    <div class="blueBox additionalInfo">
        확인된 사항:<br>
        &nbsp;&nbsp;&nbsp;parkingBikeTotCnt = 자전거주차총건수<br>
        &nbsp;&nbsp;&nbsp;rackTotCnt = 거치대개수<br>
        &nbsp;&nbsp;&nbsp;shared = 거치율<br>
        &nbsp;&nbsp;&nbsp;parkingBikeTotCnt = parkingRack + parkingQRBikeCnt<br>
        &nbsp;&nbsp;&nbsp;추후 LCD 자전거 거치건수와 QR 자전거 거치건수를 신규 컬럼으로 추가해 서비스 할 예정입니다.<br><br>
        추정되는 사항:<br>
        &nbsp;&nbsp;&nbsp;parkingBikeTotCnt = 거치중인 자전거 수 (LCD형 & QR형)<br>
        &nbsp;&nbsp;&nbsp;rackTotCnt = 거치대수(+2)<br><br>
        <div class="centerText">
            <b>Developed by Randy "VandyRandy" Kim</b><br>
        </div>
    </div>

</body>
</html>
